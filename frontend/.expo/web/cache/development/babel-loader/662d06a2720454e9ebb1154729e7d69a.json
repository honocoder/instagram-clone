{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { FontAwesome5 } from '@expo/vector-icons';\nimport firebase from 'firebase';\nimport React, { useEffect, useState } from 'react';\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { ScrollView } from 'react-native-gesture-handler';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { sendNotification } from \"../../../redux/actions/index\";\nimport { container, text, utils } from \"../../styles\";\nimport CachedImage from \"../random/CachedImage\";\n\nrequire('firebase/firestore');\n\nfunction Profile(props) {\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      userPosts = _useState2[0],\n      setUserPosts = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var _useState5 = useState(true),\n      _useState6 = _slicedToArray(_useState5, 2),\n      loading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      following = _useState8[0],\n      setFollowing = _useState8[1];\n\n  useEffect(function () {\n    var currentUser = props.currentUser,\n        posts = props.posts;\n\n    if (props.route.params.uid === firebase.auth().currentUser.uid) {\n      setUser(currentUser);\n      setUserPosts(posts);\n      setLoading(false);\n    } else {\n      firebase.firestore().collection(\"users\").doc(props.route.params.uid).get().then(function (snapshot) {\n        if (snapshot.exists) {\n          props.navigation.setOptions({\n            title: snapshot.data().username\n          });\n          setUser(_objectSpread({\n            uid: props.route.params.uid\n          }, snapshot.data()));\n        }\n\n        setLoading(false);\n      });\n      firebase.firestore().collection(\"posts\").doc(props.route.params.uid).collection(\"userPosts\").orderBy(\"creation\", \"desc\").get().then(function (snapshot) {\n        var posts = snapshot.docs.map(function (doc) {\n          var data = doc.data();\n          var id = doc.id;\n          return _objectSpread({\n            id: id\n          }, data);\n        });\n        setUserPosts(posts);\n      });\n    }\n\n    if (props.following.indexOf(props.route.params.uid) > -1) {\n      setFollowing(true);\n    } else {\n      setFollowing(false);\n    }\n  }, [props.route.params.uid, props.following, props.currentUser, props.posts]);\n\n  var onFollow = function onFollow() {\n    firebase.firestore().collection(\"following\").doc(firebase.auth().currentUser.uid).collection(\"userFollowing\").doc(props.route.params.uid).set({});\n    props.sendNotification(user.notificationToken, \"New Follower\", props.currentUser.name + \" Started following you\", {\n      type: 'profile',\n      user: firebase.auth().currentUser.uid\n    });\n  };\n\n  var onUnfollow = function onUnfollow() {\n    firebase.firestore().collection(\"following\").doc(firebase.auth().currentUser.uid).collection(\"userFollowing\").doc(props.route.params.uid).delete();\n  };\n\n  if (loading) {\n    return React.createElement(View, {\n      style: {\n        height: '100%',\n        justifyContent: 'center',\n        margin: 'auto'\n      }\n    }, React.createElement(ActivityIndicator, {\n      style: {\n        alignSelf: 'center',\n        marginBottom: 20\n      },\n      size: \"large\",\n      color: \"#00ff00\"\n    }), React.createElement(Text, {\n      style: [text.notAvailable]\n    }, \"Loading\"));\n  }\n\n  if (user === null) {\n    return React.createElement(View, {\n      style: {\n        height: '100%',\n        justifyContent: 'center',\n        margin: 'auto'\n      }\n    }, React.createElement(FontAwesome5, {\n      style: {\n        alignSelf: 'center',\n        marginBottom: 20\n      },\n      name: \"dizzy\",\n      size: 40,\n      color: \"black\"\n    }), React.createElement(Text, {\n      style: [text.notAvailable]\n    }, \"User Not Found\"));\n  }\n\n  return React.createElement(ScrollView, {\n    style: [container.container, utils.backgroundWhite]\n  }, React.createElement(View, {\n    style: [container.profileInfo]\n  }, React.createElement(View, {\n    style: [utils.noPadding, container.row]\n  }, user.image == 'default' ? React.createElement(FontAwesome5, {\n    style: [utils.profileImageBig, utils.marginBottomSmall],\n    name: \"user-circle\",\n    size: 80,\n    color: \"black\"\n  }) : React.createElement(Image, {\n    style: [utils.profileImageBig, utils.marginBottomSmall],\n    source: {\n      uri: user.image\n    }\n  }), React.createElement(View, {\n    style: [container.container, container.horizontal, utils.justifyCenter, utils.padding10Sides]\n  }, React.createElement(View, {\n    style: [utils.justifyCenter, text.center, container.containerImage]\n  }, React.createElement(Text, {\n    style: [text.bold, text.large, text.center]\n  }, userPosts.length), React.createElement(Text, {\n    style: [text.center]\n  }, \"Posts\")), React.createElement(View, {\n    style: [utils.justifyCenter, text.center, container.containerImage]\n  }, React.createElement(Text, {\n    style: [text.bold, text.large, text.center]\n  }, user.followersCount), React.createElement(Text, {\n    style: [text.center]\n  }, \"Followers\")), React.createElement(View, {\n    style: [utils.justifyCenter, text.center, container.containerImage]\n  }, React.createElement(Text, {\n    style: [text.bold, text.large, text.center]\n  }, user.followingCount), React.createElement(Text, {\n    style: [text.center]\n  }, \"Following\")))), React.createElement(View, null, React.createElement(Text, {\n    style: text.bold\n  }, user.name), React.createElement(Text, {\n    style: [text.profileDescription, utils.marginBottom]\n  }, user.description), props.route.params.uid !== firebase.auth().currentUser.uid ? React.createElement(View, {\n    style: [container.horizontal]\n  }, following ? React.createElement(TouchableOpacity, {\n    style: [utils.buttonOutlined, container.container, utils.margin15Right],\n    title: \"Following\",\n    onPress: function onPress() {\n      return onUnfollow();\n    }\n  }, React.createElement(Text, {\n    style: [text.bold, text.center, text.green]\n  }, \"Following\")) : React.createElement(TouchableOpacity, {\n    style: [utils.buttonOutlined, container.container, utils.margin15Right],\n    title: \"Follow\",\n    onPress: function onPress() {\n      return onFollow();\n    }\n  }, React.createElement(Text, {\n    style: [text.bold, text.center, {\n      color: '#2196F3'\n    }]\n  }, \"Follow\")), React.createElement(TouchableOpacity, {\n    style: [utils.buttonOutlined, container.container],\n    title: \"Follow\",\n    onPress: function onPress() {\n      return props.navigation.navigate('Chat', {\n        user: user\n      });\n    }\n  }, React.createElement(Text, {\n    style: [text.bold, text.center]\n  }, \"Message\"))) : React.createElement(TouchableOpacity, {\n    style: utils.buttonOutlined,\n    onPress: function onPress() {\n      return props.navigation.navigate('Edit');\n    }\n  }, React.createElement(Text, {\n    style: [text.bold, text.center]\n  }, \"Edit Profile\")))), React.createElement(View, {\n    style: [utils.borderTopGray]\n  }, React.createElement(FlatList, {\n    numColumns: 3,\n    horizontal: false,\n    data: userPosts,\n    style: {},\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return React.createElement(TouchableOpacity, {\n        style: [container.containerImage, utils.borderWhite],\n        onPress: function onPress() {\n          return props.navigation.navigate(\"Post\", {\n            item: item,\n            user: user\n          });\n        }\n      }, item.type == 0 ? React.createElement(CachedImage, {\n        cacheKey: item.id,\n        style: container.image,\n        source: {\n          uri: item.downloadURLStill\n        }\n      }) : React.createElement(CachedImage, {\n        cacheKey: item.id,\n        style: container.image,\n        source: {\n          uri: item.downloadURL\n        }\n      }));\n    }\n  })));\n}\n\nvar mapStateToProps = function mapStateToProps(store) {\n  return {\n    currentUser: store.userState.currentUser,\n    posts: store.userState.posts,\n    following: store.userState.following\n  };\n};\n\nvar mapDispatchProps = function mapDispatchProps(dispatch) {\n  return bindActionCreators({\n    sendNotification: sendNotification\n  }, dispatch);\n};\n\nexport default connect(mapStateToProps, mapDispatchProps)(Profile);","map":{"version":3,"sources":["/Users/jimymarletta/Downloads/instagram_redesign_release_v2/frontend/components/main/profile/Profile.js"],"names":["FontAwesome5","firebase","React","useEffect","useState","ScrollView","connect","bindActionCreators","sendNotification","container","text","utils","CachedImage","require","Profile","props","userPosts","setUserPosts","user","setUser","loading","setLoading","following","setFollowing","currentUser","posts","route","params","uid","auth","firestore","collection","doc","get","then","snapshot","exists","navigation","setOptions","title","data","username","orderBy","docs","map","id","indexOf","onFollow","set","notificationToken","name","type","onUnfollow","delete","height","justifyContent","margin","alignSelf","marginBottom","notAvailable","backgroundWhite","profileInfo","noPadding","row","image","profileImageBig","marginBottomSmall","uri","horizontal","justifyCenter","padding10Sides","center","containerImage","bold","large","length","followersCount","followingCount","profileDescription","description","buttonOutlined","margin15Right","green","color","navigate","borderTopGray","item","borderWhite","downloadURLStill","downloadURL","mapStateToProps","store","userState","mapDispatchProps","dispatch"],"mappings":"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","sourcesContent":["import { FontAwesome5 } from '@expo/vector-icons';\nimport firebase from 'firebase';\nimport React, { useEffect, useState } from 'react';\nimport { ActivityIndicator, FlatList, Image, Text, TouchableOpacity, View } from 'react-native';\nimport { ScrollView } from 'react-native-gesture-handler';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { sendNotification } from '../../../redux/actions/index';\nimport { container, text, utils } from '../../styles';\nimport CachedImage from '../random/CachedImage';\nrequire('firebase/firestore')\n\n\n\nfunction Profile(props) {\n    const [userPosts, setUserPosts] = useState([]);\n    const [user, setUser] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [following, setFollowing] = useState(false)\n\n    useEffect(() => {\n        const { currentUser, posts } = props;\n\n        if (props.route.params.uid === firebase.auth().currentUser.uid) {\n            setUser(currentUser)\n            setUserPosts(posts)\n            setLoading(false)\n        }\n        else {\n            firebase.firestore()\n                .collection(\"users\")\n                .doc(props.route.params.uid)\n                .get()\n                .then((snapshot) => {\n                    if (snapshot.exists) {\n                        props.navigation.setOptions({\n                            title: snapshot.data().username,\n                        })\n\n                        setUser({ uid: props.route.params.uid, ...snapshot.data() });\n                    }\n                    setLoading(false)\n\n                })\n            firebase.firestore()\n                .collection(\"posts\")\n                .doc(props.route.params.uid)\n                .collection(\"userPosts\")\n                .orderBy(\"creation\", \"desc\")\n                .get()\n                .then((snapshot) => {\n                    let posts = snapshot.docs.map(doc => {\n                        const data = doc.data();\n                        const id = doc.id;\n                        return { id, ...data }\n                    })\n                    setUserPosts(posts)\n                })\n        }\n\n\n        if (props.following.indexOf(props.route.params.uid) > -1) {\n            setFollowing(true);\n        } else {\n            setFollowing(false);\n        }\n\n    }, [props.route.params.uid, props.following, props.currentUser, props.posts])\n\n    const onFollow = () => {\n        firebase.firestore()\n            .collection(\"following\")\n            .doc(firebase.auth().currentUser.uid)\n            .collection(\"userFollowing\")\n            .doc(props.route.params.uid)\n            .set({})\n\n        props.sendNotification(user.notificationToken, \"New Follower\", `${props.currentUser.name} Started following you`, { type: 'profile', user: firebase.auth().currentUser.uid })\n    }\n    const onUnfollow = () => {\n        firebase.firestore()\n            .collection(\"following\")\n            .doc(firebase.auth().currentUser.uid)\n            .collection(\"userFollowing\")\n            .doc(props.route.params.uid)\n            .delete()\n    }\n\n    if (loading) {\n        return (\n            <View style={{ height: '100%', justifyContent: 'center', margin: 'auto' }}>\n                <ActivityIndicator style={{ alignSelf: 'center', marginBottom: 20 }} size=\"large\" color=\"#00ff00\" />\n                <Text style={[text.notAvailable]}>Loading</Text>\n            </View>\n        )\n    }\n    if (user === null) {\n        return (\n            <View style={{ height: '100%', justifyContent: 'center', margin: 'auto' }}>\n                <FontAwesome5 style={{ alignSelf: 'center', marginBottom: 20 }} name=\"dizzy\" size={40} color=\"black\" />\n                <Text style={[text.notAvailable]}>User Not Found</Text>\n            </View>\n        )\n    }\n    return (\n        <ScrollView style={[container.container, utils.backgroundWhite]}>\n\n            <View style={[container.profileInfo]}>\n\n                <View style={[utils.noPadding, container.row]}>\n\n                    {user.image == 'default' ?\n                        (\n                            <FontAwesome5\n                                style={[utils.profileImageBig, utils.marginBottomSmall]}\n                                name=\"user-circle\" size={80} color=\"black\" />\n                        )\n                        :\n                        (\n                            <Image\n                                style={[utils.profileImageBig, utils.marginBottomSmall]}\n                                source={{\n                                    uri: user.image\n                                }}\n                            />\n                        )\n                    }\n\n                    <View style={[container.container, container.horizontal, utils.justifyCenter, utils.padding10Sides]}>\n\n                        <View style={[utils.justifyCenter, text.center, container.containerImage]}>\n                            <Text style={[text.bold, text.large, text.center]}>{userPosts.length}</Text>\n                            <Text style={[text.center]}>Posts</Text>\n                        </View>\n                        <View style={[utils.justifyCenter, text.center, container.containerImage]}>\n                            <Text style={[text.bold, text.large, text.center]}>{user.followersCount}</Text>\n                            <Text style={[text.center]}>Followers</Text>\n                        </View>\n                        <View style={[utils.justifyCenter, text.center, container.containerImage]}>\n                            <Text style={[text.bold, text.large, text.center]}>{user.followingCount}</Text>\n                            <Text style={[text.center]}>Following</Text>\n                        </View>\n                    </View>\n\n                </View>\n\n\n                <View>\n                    <Text style={text.bold}>{user.name}</Text>\n                    <Text style={[text.profileDescription, utils.marginBottom]}>{user.description}</Text>\n\n                    {props.route.params.uid !== firebase.auth().currentUser.uid ? (\n                        <View style={[container.horizontal]}>\n                            {following ? (\n                                <TouchableOpacity\n                                    style={[utils.buttonOutlined, container.container, utils.margin15Right]}\n                                    title=\"Following\"\n                                    onPress={() => onUnfollow()}>\n                                    <Text style={[text.bold, text.center, text.green]}>Following</Text>\n                                </TouchableOpacity>\n                            )\n                                :\n                                (\n                                    <TouchableOpacity\n                                        style={[utils.buttonOutlined, container.container, utils.margin15Right]}\n                                        title=\"Follow\"\n                                        onPress={() => onFollow()}>\n                                        <Text style={[text.bold, text.center, { color: '#2196F3' }]}>Follow</Text>\n                                    </TouchableOpacity>\n\n                                )}\n\n                            <TouchableOpacity\n                                style={[utils.buttonOutlined, container.container]}\n                                title=\"Follow\"\n                                onPress={() => props.navigation.navigate('Chat', { user })}>\n                                <Text style={[text.bold, text.center]}>Message</Text>\n                            </TouchableOpacity>\n                        </View>\n                    ) :\n                        <TouchableOpacity\n                            style={utils.buttonOutlined}\n                            onPress={() => props.navigation.navigate('Edit')}>\n                            <Text style={[text.bold, text.center]}>Edit Profile</Text>\n                        </TouchableOpacity>}\n                </View>\n            </View>\n\n            <View style={[utils.borderTopGray]}>\n                <FlatList\n                    numColumns={3}\n                    horizontal={false}\n                    data={userPosts}\n                    style={{}}\n                    renderItem={({ item }) => (\n                        <TouchableOpacity\n                            style={[container.containerImage, utils.borderWhite]}\n                            onPress={() => props.navigation.navigate(\"Post\", { item, user })}>\n\n                            {item.type == 0 ?\n\n                                <CachedImage\n                                    cacheKey={item.id}\n                                    style={container.image}\n                                    source={{ uri: item.downloadURLStill }}\n                                />\n\n                                :\n\n                                <CachedImage\n                                    cacheKey={item.id}\n                                    style={container.image}\n                                    source={{ uri: item.downloadURL }}\n                                />\n                            }\n                        </TouchableOpacity>\n\n                    )}\n\n                />\n            </View>\n        </ScrollView >\n\n    )\n}\n\nconst mapStateToProps = (store) => ({\n    currentUser: store.userState.currentUser,\n    posts: store.userState.posts,\n    following: store.userState.following\n\n})\n\nconst mapDispatchProps = (dispatch) => bindActionCreators({ sendNotification }, dispatch);\n\nexport default connect(mapStateToProps, mapDispatchProps)(Profile);\n\n"]},"metadata":{},"sourceType":"module"}