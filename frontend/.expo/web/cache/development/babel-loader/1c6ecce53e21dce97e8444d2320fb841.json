{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport { Feather } from '@expo/vector-icons';\nimport { useIsFocused } from '@react-navigation/native';\nimport { Audio } from \"expo-av\";\nimport { Camera } from \"expo-camera\";\nimport * as ImagePicker from 'expo-image-picker';\nimport * as MediaLibrary from 'expo-media-library';\nimport * as VideoThumbnails from 'expo-video-thumbnails';\nimport React, { useEffect, useRef, useState } from \"react\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { container, utils } from \"../../styles\";\nvar WINDOW_HEIGHT = Dimensions.get(\"window\").height;\nvar WINDOW_WIDTH = Dimensions.get(\"window\").width;\nvar closeButtonSize = Math.floor(WINDOW_HEIGHT * 0.032);\nvar captureSize = Math.floor(WINDOW_HEIGHT * 0.09);\nexport default function VideoScreen(props) {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      hasPermission = _useState2[0],\n      setHasPermission = _useState2[1];\n\n  var _useState3 = useState(Camera.Constants.Type.back),\n      _useState4 = _slicedToArray(_useState3, 2),\n      cameraType = _useState4[0],\n      setCameraType = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      isPreview = _useState6[0],\n      setIsPreview = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isCameraReady = _useState8[0],\n      setIsCameraReady = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      isFlash = _useState10[0],\n      setIsFlash = _useState10[1];\n\n  var _useState11 = useState(false),\n      _useState12 = _slicedToArray(_useState11, 2),\n      isVideoRecording = _useState12[0],\n      setIsVideoRecording = _useState12[1];\n\n  var _useState13 = useState(0),\n      _useState14 = _slicedToArray(_useState13, 2),\n      type = _useState14[0],\n      setType = _useState14[1];\n\n  var _useState15 = useState(true),\n      _useState16 = _slicedToArray(_useState15, 2),\n      showGallery = _useState16[0],\n      setShowGallery = _useState16[1];\n\n  var _useState17 = useState([]),\n      _useState18 = _slicedToArray(_useState17, 2),\n      galleryItems = _useState18[0],\n      setGalleryItems = _useState18[1];\n\n  var _useState19 = useState(null),\n      _useState20 = _slicedToArray(_useState19, 2),\n      galleryScrollRef = _useState20[0],\n      setGalleryScrollRef = _useState20[1];\n\n  var _useState21 = useState(null),\n      _useState22 = _slicedToArray(_useState21, 2),\n      galleryPickedImage = _useState22[0],\n      setGalleryPickedImage = _useState22[1];\n\n  var cameraRef = useRef();\n  var isFocused = useIsFocused();\n  useEffect(function () {\n    (function _callee() {\n      var cameraPermissions, galleryPermissions, audioPermissions, getPhotos;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Camera.requestPermissionsAsync());\n\n            case 2:\n              cameraPermissions = _context.sent;\n              _context.next = 5;\n              return _regeneratorRuntime.awrap(MediaLibrary.requestPermissionsAsync());\n\n            case 5:\n              galleryPermissions = _context.sent;\n              _context.next = 8;\n              return _regeneratorRuntime.awrap(Audio.requestPermissionsAsync());\n\n            case 8:\n              audioPermissions = _context.sent;\n\n              if (!(cameraPermissions.status === 'granted' && audioPermissions.status === 'granted' && galleryPermissions.status === 'granted')) {\n                _context.next = 16;\n                break;\n              }\n\n              _context.next = 12;\n              return _regeneratorRuntime.awrap(MediaLibrary.getAssetsAsync({\n                sortBy: ['creationTime'],\n                mediaType: ['photo', 'video']\n              }));\n\n            case 12:\n              getPhotos = _context.sent;\n              setGalleryItems(getPhotos);\n              setGalleryPickedImage(getPhotos.assets[0]);\n              setHasPermission(true);\n\n            case 16:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  var onCameraReady = function onCameraReady() {\n    setIsCameraReady(true);\n  };\n\n  var takePicture = function takePicture() {\n    var options, data, source;\n    return _regeneratorRuntime.async(function takePicture$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (!cameraRef.current) {\n              _context2.next = 7;\n              break;\n            }\n\n            options = {\n              quality: 0.5,\n              base64: true,\n              skipProcessing: true\n            };\n            _context2.next = 4;\n            return _regeneratorRuntime.awrap(cameraRef.current.takePictureAsync(options));\n\n          case 4:\n            data = _context2.sent;\n            source = data.uri;\n\n            if (source) {\n              props.navigation.navigate('Save', {\n                source: source,\n                imageSource: null,\n                type: type\n              });\n            }\n\n          case 7:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var recordVideo = function recordVideo() {\n    var options, videoRecordPromise, data, source, imageSource;\n    return _regeneratorRuntime.async(function recordVideo$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (!cameraRef.current) {\n              _context3.next = 19;\n              break;\n            }\n\n            _context3.prev = 1;\n            options = {\n              maxDuration: 60,\n              quality: Camera.Constants.VideoQuality['480p']\n            };\n            videoRecordPromise = cameraRef.current.recordAsync(options);\n\n            if (!videoRecordPromise) {\n              _context3.next = 14;\n              break;\n            }\n\n            setIsVideoRecording(true);\n            _context3.next = 8;\n            return _regeneratorRuntime.awrap(videoRecordPromise);\n\n          case 8:\n            data = _context3.sent;\n            source = data.uri;\n            _context3.next = 12;\n            return _regeneratorRuntime.awrap(generateThumbnail(source));\n\n          case 12:\n            imageSource = _context3.sent;\n            props.navigation.navigate('Save', {\n              source: source,\n              imageSource: imageSource,\n              type: type\n            });\n\n          case 14:\n            _context3.next = 19;\n            break;\n\n          case 16:\n            _context3.prev = 16;\n            _context3.t0 = _context3[\"catch\"](1);\n            console.warn(_context3.t0);\n\n          case 19:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[1, 16]], Promise);\n  };\n\n  var generateThumbnail = function generateThumbnail(source) {\n    var _await$VideoThumbnail, uri;\n\n    return _regeneratorRuntime.async(function generateThumbnail$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.prev = 0;\n            _context4.next = 3;\n            return _regeneratorRuntime.awrap(VideoThumbnails.getThumbnailAsync(source, {\n              time: 5000\n            }));\n\n          case 3:\n            _await$VideoThumbnail = _context4.sent;\n            uri = _await$VideoThumbnail.uri;\n            return _context4.abrupt(\"return\", uri);\n\n          case 8:\n            _context4.prev = 8;\n            _context4.t0 = _context4[\"catch\"](0);\n            console.warn(_context4.t0);\n\n          case 11:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[0, 8]], Promise);\n  };\n\n  var stopVideoRecording = function stopVideoRecording() {\n    return _regeneratorRuntime.async(function stopVideoRecording$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            if (cameraRef.current) {\n              setIsVideoRecording(false);\n              cameraRef.current.stopRecording();\n            }\n\n          case 1:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var switchCamera = function switchCamera() {\n    if (isPreview) {\n      return;\n    }\n\n    setCameraType(function (prevCameraType) {\n      return prevCameraType === Camera.Constants.Type.back ? Camera.Constants.Type.front : Camera.Constants.Type.back;\n    });\n  };\n\n  var handleGoToSaveOnGalleryPick = function handleGoToSaveOnGalleryPick() {\n    var type, loadedAsset, imageSource;\n    return _regeneratorRuntime.async(function handleGoToSaveOnGalleryPick$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            type = galleryPickedImage.mediaType == 'video' ? 0 : 1;\n            _context6.next = 3;\n            return _regeneratorRuntime.awrap(MediaLibrary.getAssetInfoAsync(galleryPickedImage));\n\n          case 3:\n            loadedAsset = _context6.sent;\n            imageSource = null;\n\n            if (!(type == 0)) {\n              _context6.next = 9;\n              break;\n            }\n\n            _context6.next = 8;\n            return _regeneratorRuntime.awrap(generateThumbnail(galleryPickedImage.uri));\n\n          case 8:\n            imageSource = _context6.sent;\n\n          case 9:\n            props.navigation.navigate('Save', {\n              source: loadedAsset.localUri,\n              type: type,\n              imageSource: imageSource\n            });\n\n          case 10:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var renderCaptureControl = function renderCaptureControl() {\n    return React.createElement(View, null, React.createElement(View, {\n      style: {\n        justifyContent: 'space-evenly',\n        width: '100%',\n        alignItems: 'center',\n        flexDirection: 'row',\n        backgroundColor: 'white'\n      }\n    }, React.createElement(TouchableOpacity, {\n      disabled: !isCameraReady,\n      onPress: function onPress() {\n        return setIsFlash(!isFlash);\n      }\n    }, React.createElement(Feather, {\n      style: utils.margin15,\n      name: \"zap\",\n      size: 25,\n      color: \"black\"\n    })), React.createElement(TouchableOpacity, {\n      disabled: !isCameraReady,\n      onPress: switchCamera\n    }, React.createElement(Feather, {\n      style: utils.margin15,\n      name: \"rotate-cw\",\n      size: 25,\n      color: \"black\"\n    })), type == 0 ? React.createElement(TouchableOpacity, {\n      activeOpacity: 0.7,\n      disabled: !isCameraReady,\n      onLongPress: recordVideo,\n      onPressOut: stopVideoRecording,\n      style: styles.capture\n    }) : React.createElement(TouchableOpacity, {\n      activeOpacity: 0.7,\n      disabled: !isCameraReady,\n      onPress: takePicture,\n      style: styles.capturePicture\n    }), React.createElement(TouchableOpacity, {\n      disabled: !isCameraReady,\n      onPress: function onPress() {\n        return type == 1 ? setType(0) : setType(1);\n      }\n    }, React.createElement(Feather, {\n      style: utils.margin15,\n      name: type == 0 ? \"camera\" : \"video\",\n      size: 25,\n      color: \"black\"\n    })), React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        return setShowGallery(true);\n      }\n    }, React.createElement(Feather, {\n      style: utils.margin15,\n      name: \"image\",\n      size: 25,\n      color: \"black\"\n    }))));\n  };\n\n  if (hasPermission === null) {\n    return React.createElement(View, null);\n  }\n\n  if (hasPermission === false) {\n    return React.createElement(Text, {\n      style: styles.text\n    }, \"No access to camera\");\n  }\n\n  if (showGallery) {\n    return React.createElement(ScrollView, {\n      ref: function ref(_ref2) {\n        return setGalleryScrollRef(_ref2);\n      },\n      style: [container.container, utils.backgroundWhite]\n    }, React.createElement(View, {\n      style: [{\n        aspectRatio: 1 / 1,\n        height: WINDOW_WIDTH\n      }]\n    }, React.createElement(Image, {\n      style: {\n        flex: 1\n      },\n      source: {\n        uri: galleryPickedImage.uri\n      },\n      style: [{\n        aspectRatio: 1 / 1,\n        height: WINDOW_WIDTH\n      }],\n      ratio: '1:1'\n    })), React.createElement(View, {\n      style: {\n        justifyContent: 'flex-end',\n        alignItems: 'center',\n        marginRight: 20,\n        marginVertical: 10,\n        flexDirection: 'row'\n      }\n    }, React.createElement(TouchableOpacity, {\n      style: {\n        alignItems: 'center',\n        backgroundColor: 'gray',\n        paddingHorizontal: 20,\n        paddingVertical: 10,\n        marginRight: 15,\n        borderRadius: 50,\n        borderWidth: 1,\n        borderColor: 'black'\n      },\n      onPress: function onPress() {\n        return handleGoToSaveOnGalleryPick();\n      }\n    }, React.createElement(Text, {\n      style: {\n        fontWeight: 'bold',\n        color: 'white',\n        paddingBottom: 1\n      }\n    }, \"Continue\")), React.createElement(TouchableOpacity, {\n      style: {\n        alignItems: 'center',\n        backgroundColor: 'gray',\n        borderRadius: 50,\n        borderWidth: 1,\n        borderColor: 'black'\n      },\n      onPress: function onPress() {\n        return setShowGallery(false);\n      }\n    }, React.createElement(Feather, {\n      style: {\n        padding: 10\n      },\n      name: \"camera\",\n      size: 20,\n      color: \"white\"\n    }))), React.createElement(View, {\n      style: ({\n        flex: 1\n      }, [utils.borderTopGray])\n    }, React.createElement(FlatList, {\n      numColumns: 3,\n      horizontal: false,\n      data: galleryItems.assets,\n      contentContainerStyle: {\n        flexGrow: 1\n      },\n      renderItem: function renderItem(_ref) {\n        var item = _ref.item;\n        return React.createElement(TouchableOpacity, {\n          style: [container.containerImage, utils.borderWhite],\n          onPress: function onPress() {\n            galleryScrollRef.scrollTo({\n              x: 0,\n              y: 0,\n              animated: true\n            });\n            setGalleryPickedImage(item);\n          }\n        }, React.createElement(Image, {\n          style: container.image,\n          source: {\n            uri: item.uri\n          }\n        }));\n      }\n    })));\n  }\n\n  return React.createElement(View, {\n    style: {\n      flex: 1,\n      flexDirection: 'column',\n      backgroundColor: 'white'\n    }\n  }, React.createElement(View, {\n    style: [{\n      aspectRatio: 1 / 1,\n      height: WINDOW_WIDTH\n    }]\n  }, isFocused ? React.createElement(Camera, {\n    ref: cameraRef,\n    style: {\n      flex: 1\n    },\n    type: cameraType,\n    flashMode: isFlash ? Camera.Constants.FlashMode.torch : Camera.Constants.FlashMode.off,\n    style: [{\n      aspectRatio: 1 / 1,\n      height: WINDOW_WIDTH\n    }],\n    ratio: '1:1',\n    onCameraReady: onCameraReady\n  }) : null), React.createElement(View, {\n    style: [{\n      flexDirection: 'row',\n      alignItems: 'center',\n      flex: 1\n    }]\n  }, React.createElement(View, null, renderCaptureControl())));\n}\nvar styles = StyleSheet.create({\n  closeButton: {\n    position: \"absolute\",\n    top: 35,\n    left: 15,\n    height: closeButtonSize,\n    width: closeButtonSize,\n    borderRadius: Math.floor(closeButtonSize / 2),\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#c4c5c4\",\n    opacity: 0.7,\n    zIndex: 2\n  },\n  media: _objectSpread({}, StyleSheet.absoluteFillObject),\n  closeCross: {\n    width: \"68%\",\n    height: 1,\n    backgroundColor: \"black\"\n  },\n  control: {\n    position: \"absolute\",\n    flexDirection: \"row\",\n    bottom: 38,\n    width: \"100%\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  recordIndicatorContainer: {\n    flexDirection: \"row\",\n    position: \"absolute\",\n    top: 0,\n    opacity: 0.7\n  },\n  recordTitle: {\n    fontSize: 14,\n    color: \"black\",\n    textAlign: \"center\"\n  },\n  recordDot: {\n    borderRadius: 3,\n    height: 6,\n    width: 6,\n    backgroundColor: \"#ff0000\",\n    marginHorizontal: 5\n  },\n  text: {\n    color: \"#000000\"\n  },\n  capture: {\n    backgroundColor: \"red\",\n    borderRadius: 5,\n    height: captureSize,\n    width: captureSize,\n    borderRadius: Math.floor(captureSize / 2),\n    marginHorizontal: 31\n  },\n  capturePicture: {\n    borderWidth: 6,\n    borderColor: 'gray',\n    backgroundColor: \"white\",\n    borderRadius: 5,\n    height: captureSize,\n    width: captureSize,\n    borderRadius: Math.floor(captureSize / 2),\n    marginHorizontal: 31\n  }\n});","map":{"version":3,"sources":["/Users/jimymarletta/Downloads/instagram_redesign_release_v2/frontend/components/main/add/Camera.js"],"names":["Feather","useIsFocused","Audio","Camera","ImagePicker","MediaLibrary","VideoThumbnails","React","useEffect","useRef","useState","container","utils","WINDOW_HEIGHT","Dimensions","get","height","WINDOW_WIDTH","width","closeButtonSize","Math","floor","captureSize","VideoScreen","props","hasPermission","setHasPermission","Constants","Type","back","cameraType","setCameraType","isPreview","setIsPreview","isCameraReady","setIsCameraReady","isFlash","setIsFlash","isVideoRecording","setIsVideoRecording","type","setType","showGallery","setShowGallery","galleryItems","setGalleryItems","galleryScrollRef","setGalleryScrollRef","galleryPickedImage","setGalleryPickedImage","cameraRef","isFocused","requestPermissionsAsync","cameraPermissions","galleryPermissions","audioPermissions","status","getAssetsAsync","sortBy","mediaType","getPhotos","assets","onCameraReady","takePicture","current","options","quality","base64","skipProcessing","takePictureAsync","data","source","uri","navigation","navigate","imageSource","recordVideo","maxDuration","VideoQuality","videoRecordPromise","recordAsync","generateThumbnail","console","warn","getThumbnailAsync","time","stopVideoRecording","stopRecording","switchCamera","prevCameraType","front","handleGoToSaveOnGalleryPick","getAssetInfoAsync","loadedAsset","localUri","renderCaptureControl","justifyContent","alignItems","flexDirection","backgroundColor","margin15","styles","capture","capturePicture","text","ref","backgroundWhite","aspectRatio","flex","marginRight","marginVertical","paddingHorizontal","paddingVertical","borderRadius","borderWidth","borderColor","fontWeight","color","paddingBottom","padding","borderTopGray","flexGrow","item","containerImage","borderWhite","scrollTo","x","y","animated","image","FlashMode","torch","off","StyleSheet","create","closeButton","position","top","left","opacity","zIndex","media","absoluteFillObject","closeCross","control","bottom","recordIndicatorContainer","recordTitle","fontSize","textAlign","recordDot","marginHorizontal"],"mappings":"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","sourcesContent":["import { Feather } from '@expo/vector-icons';\nimport { useIsFocused } from '@react-navigation/native';\nimport { Audio } from \"expo-av\";\nimport { Camera } from \"expo-camera\";\nimport * as ImagePicker from 'expo-image-picker';\nimport * as MediaLibrary from 'expo-media-library';\nimport * as VideoThumbnails from 'expo-video-thumbnails';\nimport React, { useEffect, useRef, useState } from \"react\";\nimport {\n    Dimensions, FlatList, Image, ScrollView, StyleSheet, Text, TouchableOpacity, View\n} from \"react-native\";\nimport { container, utils } from '../../styles';\nconst WINDOW_HEIGHT = Dimensions.get(\"window\").height;\nconst WINDOW_WIDTH = Dimensions.get(\"window\").width;\nconst closeButtonSize = Math.floor(WINDOW_HEIGHT * 0.032);\nconst captureSize = Math.floor(WINDOW_HEIGHT * 0.09);\n\n\n\n\n\nexport default function VideoScreen(props) {\n    const [hasPermission, setHasPermission] = useState(null);\n    const [cameraType, setCameraType] = useState(Camera.Constants.Type.back);\n    const [isPreview, setIsPreview] = useState(false);\n    const [isCameraReady, setIsCameraReady] = useState(false);\n    const [isFlash, setIsFlash] = useState(false);\n    const [isVideoRecording, setIsVideoRecording] = useState(false);\n    const [type, setType] = useState(0);\n    const [showGallery, setShowGallery] = useState(true)\n    const [galleryItems, setGalleryItems] = useState([])\n    const [galleryScrollRef, setGalleryScrollRef] = useState(null)\n    const [galleryPickedImage, setGalleryPickedImage] = useState(null)\n    const cameraRef = useRef();\n    const isFocused = useIsFocused();\n\n    useEffect(() => {\n        (async () => {\n\n            const cameraPermissions = await Camera.requestPermissionsAsync();\n            const galleryPermissions = await MediaLibrary.requestPermissionsAsync();\n\n            const audioPermissions = await Audio.requestPermissionsAsync();\n\n            if (cameraPermissions.status === 'granted' && audioPermissions.status === 'granted' && galleryPermissions.status === 'granted') {\n                const getPhotos = await MediaLibrary.getAssetsAsync({ sortBy: ['creationTime'], mediaType: ['photo', 'video'] })\n                setGalleryItems(getPhotos)\n                setGalleryPickedImage(getPhotos.assets[0])\n                setHasPermission(true)\n\n            }\n\n        })();\n    }, []);\n    const onCameraReady = () => {\n        setIsCameraReady(true);\n    };\n    const takePicture = async () => {\n        if (cameraRef.current) {\n            const options = { quality: 0.5, base64: true, skipProcessing: true };\n            const data = await cameraRef.current.takePictureAsync(options);\n            const source = data.uri;\n            if (source) {\n                props.navigation.navigate('Save', { source, imageSource: null, type })\n            }\n        }\n    };\n    const recordVideo = async () => {\n        if (cameraRef.current) {\n            try {\n\n                const options = { maxDuration: 60, quality: Camera.Constants.VideoQuality['480p'] }\n\n\n                const videoRecordPromise = cameraRef.current.recordAsync(options);\n                if (videoRecordPromise) {\n                    setIsVideoRecording(true);\n                    const data = await videoRecordPromise;\n                    const source = data.uri;\n                    let imageSource = await generateThumbnail(source)\n                    props.navigation.navigate('Save', { source, imageSource, type })\n\n                }\n            } catch (error) {\n                console.warn(error);\n            }\n        }\n    };\n    const generateThumbnail = async (source) => {\n        try {\n            const { uri } = await VideoThumbnails.getThumbnailAsync(\n                source,\n                {\n                    time: 5000,\n                }\n            );\n            return uri;\n        } catch (e) {\n            console.warn(e);\n        }\n    };\n\n\n    const stopVideoRecording = async () => {\n\n        if (cameraRef.current) {\n            setIsVideoRecording(false);\n            cameraRef.current.stopRecording();\n        }\n    };\n    const switchCamera = () => {\n        if (isPreview) {\n            return;\n        }\n        setCameraType((prevCameraType) =>\n            prevCameraType === Camera.Constants.Type.back\n                ? Camera.Constants.Type.front\n                : Camera.Constants.Type.back\n        );\n    };\n    const handleGoToSaveOnGalleryPick = async () => {\n        let type = galleryPickedImage.mediaType == 'video' ? 0 : 1\n\n\n        const loadedAsset = await MediaLibrary.getAssetInfoAsync(galleryPickedImage);\n        let imageSource = null\n        if (type == 0) {\n            imageSource = await generateThumbnail(galleryPickedImage.uri)\n\n        }\n\n        props.navigation.navigate('Save', {\n            source: loadedAsset.localUri,\n            type,\n            imageSource\n        })\n    }\n\n    const renderCaptureControl = () => (\n        <View>\n            <View style={{ justifyContent: 'space-evenly', width: '100%', alignItems: 'center', flexDirection: 'row', backgroundColor: 'white' }}>\n                <TouchableOpacity disabled={!isCameraReady} onPress={() => setIsFlash(!isFlash)} >\n                    <Feather style={utils.margin15} name={\"zap\"} size={25} color=\"black\" />\n                </TouchableOpacity>\n                <TouchableOpacity disabled={!isCameraReady} onPress={switchCamera}>\n                    <Feather style={utils.margin15} name=\"rotate-cw\" size={25} color=\"black\" />\n                </TouchableOpacity>\n                {type == 0 ?\n\n                    <TouchableOpacity\n                        activeOpacity={0.7}\n                        disabled={!isCameraReady}\n                        onLongPress={recordVideo}\n                        onPressOut={stopVideoRecording}\n                        style={styles.capture}\n                    />\n                    :\n                    <TouchableOpacity\n                        activeOpacity={0.7}\n                        disabled={!isCameraReady}\n                        onPress={takePicture}\n                        style={styles.capturePicture}\n                    />}\n\n                <TouchableOpacity disabled={!isCameraReady} onPress={() => type == 1 ? setType(0) : setType(1)} >\n                    <Feather style={utils.margin15} name={type == 0 ? \"camera\" : \"video\"} size={25} color=\"black\" />\n                </TouchableOpacity>\n                <TouchableOpacity onPress={() => setShowGallery(true)} >\n                    <Feather style={utils.margin15} name={\"image\"} size={25} color=\"black\" />\n                </TouchableOpacity>\n            </View>\n\n        </View>\n\n    );\n    if (hasPermission === null) {\n        return <View />;\n    }\n    if (hasPermission === false) {\n        return <Text style={styles.text}>No access to camera</Text>;\n    }\n\n    if (showGallery) {\n        return (\n            <ScrollView\n                ref={(ref) => setGalleryScrollRef(ref)}\n                style={[container.container, utils.backgroundWhite]}>\n\n                <View\n                    style={[{ aspectRatio: 1 / 1, height: WINDOW_WIDTH }]}>\n                    <Image\n                        style={{ flex: 1 }}\n                        source={{ uri: galleryPickedImage.uri }}\n\n                        style={[{ aspectRatio: 1 / 1, height: WINDOW_WIDTH }]}\n                        ratio={'1:1'}\n\n                    />\n                </View>\n                <View style={{ justifyContent: 'flex-end', alignItems: 'center', marginRight: 20, marginVertical: 10, flexDirection: 'row' }}>\n\n                    <TouchableOpacity\n                        style={{ alignItems: 'center', backgroundColor: 'gray', paddingHorizontal: 20, paddingVertical: 10, marginRight: 15, borderRadius: 50, borderWidth: 1, borderColor: 'black' }}\n                        onPress={() => handleGoToSaveOnGalleryPick()} >\n\n                        <Text style={{ fontWeight: 'bold', color: 'white', paddingBottom: 1 }}>Continue</Text>\n                    </TouchableOpacity>\n                    <TouchableOpacity style={{ alignItems: 'center', backgroundColor: 'gray', borderRadius: 50, borderWidth: 1, borderColor: 'black' }} onPress={() => setShowGallery(false)} >\n                        <Feather style={{ padding: 10 }} name={\"camera\"} size={20} color=\"white\" />\n                    </TouchableOpacity>\n                </View>\n                <View style={{ flex: 1 }, [utils.borderTopGray]}>\n\n                    <FlatList\n                        numColumns={3}\n                        horizontal={false}\n                        data={galleryItems.assets}\n\n                        contentContainerStyle={{\n                            flexGrow: 1,\n                        }}\n                        renderItem={({ item }) => (\n                            <TouchableOpacity\n                                style={[container.containerImage, utils.borderWhite]}\n                                onPress={() => { galleryScrollRef.scrollTo({ x: 0, y: 0, animated: true }); setGalleryPickedImage(item); }}>\n\n                                <Image\n                                    style={container.image}\n                                    source={{ uri: item.uri }}\n                                />\n\n                            </TouchableOpacity>\n\n                        )}\n\n                    />\n                </View>\n\n            </ScrollView>\n        )\n    }\n    return (\n        <View style={{ flex: 1, flexDirection: 'column', backgroundColor: 'white' }}>\n\n            <View\n\n                style={[{ aspectRatio: 1 / 1, height: WINDOW_WIDTH }]}>\n                {isFocused ?\n                    <Camera\n                        ref={cameraRef}\n                        style={{ flex: 1 }}\n                        type={cameraType}\n                        flashMode={isFlash ? Camera.Constants.FlashMode.torch : Camera.Constants.FlashMode.off}\n                        style={[{ aspectRatio: 1 / 1, height: WINDOW_WIDTH }]}\n                        ratio={'1:1'}\n                        onCameraReady={onCameraReady}\n                    />\n                    : null}\n\n            </View>\n\n            <View style={[{\n                flexDirection: 'row',\n                alignItems: 'center',\n                flex: 1,\n            }]}>\n                <View>\n                    {renderCaptureControl()}\n                </View>\n\n            </View>\n        </View>\n    );\n}\nconst styles = StyleSheet.create({\n    closeButton: {\n        position: \"absolute\",\n        top: 35,\n        left: 15,\n        height: closeButtonSize,\n        width: closeButtonSize,\n        borderRadius: Math.floor(closeButtonSize / 2),\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        backgroundColor: \"#c4c5c4\",\n        opacity: 0.7,\n        zIndex: 2,\n    },\n    media: {\n        ...StyleSheet.absoluteFillObject,\n    },\n    closeCross: {\n        width: \"68%\",\n        height: 1,\n        backgroundColor: \"black\",\n    },\n    control: {\n        position: \"absolute\",\n        flexDirection: \"row\",\n        bottom: 38,\n        width: \"100%\",\n\n        alignItems: \"center\",\n        justifyContent: \"center\",\n    },\n    recordIndicatorContainer: {\n        flexDirection: \"row\",\n        position: \"absolute\",\n        top: 0,\n        opacity: 0.7,\n    },\n    recordTitle: {\n        fontSize: 14,\n        color: \"black\",\n        textAlign: \"center\",\n    },\n    recordDot: {\n        borderRadius: 3,\n        height: 6,\n        width: 6,\n        backgroundColor: \"#ff0000\",\n        marginHorizontal: 5,\n    },\n    text: {\n        color: \"#000000\",\n    },\n\n    capture: {\n        backgroundColor: \"red\",\n        borderRadius: 5,\n        height: captureSize,\n        width: captureSize,\n        borderRadius: Math.floor(captureSize / 2),\n        marginHorizontal: 31,\n    },\n    capturePicture: {\n        borderWidth: 6,\n        borderColor: 'gray',\n        backgroundColor: \"white\",\n        borderRadius: 5,\n        height: captureSize,\n        width: captureSize,\n        borderRadius: Math.floor(captureSize / 2),\n        marginHorizontal: 31,\n    },\n});\n"]},"metadata":{},"sourceType":"module"}